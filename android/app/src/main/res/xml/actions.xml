<?xml version="1.0" encoding="utf-8"?>
<actions>
    <!--
        Google Assistant App Actions Configuration for Just Spent

        This file defines how Google Assistant/Gemini recognizes and processes
        voice commands for expense tracking.

        Recommended voice commands (grammatically correct):
        - "Hey Google, log 50 dirhams for groceries in Just Spent"
        - "Hey Google, record 100 dollars for shopping in Just Spent"
        - "Hey Google, add expense in Just Spent"
        - "Hey Google, track 75 dirhams for food using Just Spent"

        Note: Always include "in Just Spent", "using Just Spent", or "to Just Spent"
        for reliable app invocation. Avoid phrases like "spent in Just Spent" as
        they are grammatically incorrect (you spend money at a store, not in an app).
    -->

    <!-- Log Expense Action using CREATE_MONEY_TRANSFER Built-in Intent -->
    <action intentName="actions.intent.CREATE_MONEY_TRANSFER">
        <fulfillment urlTemplate="justspent://expense{?amount,currency,category,merchant,note}">
            <!-- Amount mapping -->
            <parameter-mapping
                intentParameter="moneyTransfer.amount.value"
                urlParameter="amount" />
            <!-- Currency mapping -->
            <parameter-mapping
                intentParameter="moneyTransfer.amount.currency"
                urlParameter="currency" />
            <!-- Category mapping -->
            <parameter-mapping
                intentParameter="moneyTransfer.category"
                urlParameter="category" />
            <!-- Merchant mapping -->
            <parameter-mapping
                intentParameter="merchant.name"
                urlParameter="merchant" />
            <!-- Description/note mapping -->
            <parameter-mapping
                intentParameter="description"
                urlParameter="note" />
        </fulfillment>

        <!-- Inline inventory for categories -->
        <parameter name="moneyTransfer.category">
            <entity-set-reference entitySetId="ExpenseCategories" />
        </parameter>
    </action>
    
    <!-- View Expenses Action -->
    <action intentName="actions.intent.GET_FINANCIAL_ACCOUNT">
        <fulfillment urlTemplate="justspent://view{?period,category}">
            <parameter-mapping
                intentParameter="temporalCoverage.endDate"
                urlParameter="period" />
            <parameter-mapping
                intentParameter="category"
                urlParameter="category" />
        </fulfillment>
    </action>
    
    <!-- Custom Quick Expense Action -->
    <action intentName="custom.actions.intent.QUICK_EXPENSE">
        <fulfillment urlTemplate="justspent://expense{?command}">
            <parameter-mapping
                intentParameter="text"
                urlParameter="command" />
        </fulfillment>
    </action>
    
    <!-- Natural Language Expense Action -->
    <action intentName="actions.intent.CREATE_THING">
        <fulfillment urlTemplate="justspent://expense{?command}">
            <parameter-mapping
                intentParameter="thing.name"
                urlParameter="command" />
        </fulfillment>
        <parameter name="thing.name">
            <entity-set-reference entitySetId="ExpenseCommands" />
        </parameter>
    </action>

    <!-- Fallback Action: Open App Feature -->
    <action intentName="actions.intent.OPEN_APP_FEATURE">
        <fulfillment urlTemplate="justspent://expense" />
    </action>

    <!-- Entity Sets -->
    <entity-set entitySetId="ExpenseCategories">
        <entity identifier="FOOD" name="Food &amp; Dining">
            <synonym>dining</synonym>
            <synonym>restaurant</synonym>
            <synonym>meal</synonym>
        </entity>
        <entity identifier="GROCERY" name="Grocery">
            <synonym>groceries</synonym>
            <synonym>supermarket</synonym>
            <synonym>shopping</synonym>
        </entity>
        <entity identifier="TRANSPORT" name="Transportation">
            <synonym>transportation</synonym>
            <synonym>taxi</synonym>
            <synonym>gas</synonym>
            <synonym>fuel</synonym>
        </entity>
        <entity identifier="SHOPPING" name="Shopping">
            <synonym>store</synonym>
            <synonym>mall</synonym>
            <synonym>purchase</synonym>
        </entity>
        <entity identifier="ENTERTAINMENT" name="Entertainment">
            <synonym>movie</synonym>
            <synonym>cinema</synonym>
            <synonym>fun</synonym>
        </entity>
        <entity identifier="BILLS" name="Bills &amp; Utilities">
            <synonym>utility</synonym>
            <synonym>electricity</synonym>
            <synonym>rent</synonym>
        </entity>
        <entity identifier="HEALTHCARE" name="Healthcare">
            <synonym>doctor</synonym>
            <synonym>hospital</synonym>
            <synonym>medicine</synonym>
        </entity>
        <entity identifier="EDUCATION" name="Education">
            <synonym>school</synonym>
            <synonym>course</synonym>
            <synonym>training</synonym>
        </entity>
        <entity identifier="OTHER" name="Other">
            <synonym>misc</synonym>
            <synonym>miscellaneous</synonym>
        </entity>
    </entity-set>
    
    <!-- Entity Set for Natural Language Expense Commands -->
    <entity-set entitySetId="ExpenseCommands">
        <entity identifier="SPENT_ON" name="spent money on">
            <synonym>I spent</synonym>
            <synonym>I just spent</synonym>
            <synonym>I paid</synonym>
            <synonym>just paid</synonym>
            <synonym>expense of</synonym>
            <synonym>cost me</synonym>
        </entity>
        <entity identifier="LOG_EXPENSE" name="log expense">
            <synonym>add expense</synonym>
            <synonym>record expense</synonym>
            <synonym>save expense</synonym>
            <synonym>track expense</synonym>
        </entity>
        <entity identifier="BOUGHT_ITEM" name="bought something">
            <synonym>I bought</synonym>
            <synonym>purchased</synonym>
            <synonym>got something</synonym>
            <synonym>picked up</synonym>
        </entity>
    </entity-set>
</actions>